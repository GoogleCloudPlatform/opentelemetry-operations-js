version: 2

unit_tests: &unit_tests
  steps:
    - checkout
    - run:
        name: Install modules and dependencies.
        command: npm install
    - run:
        name: Unit tests
        command: npm run test

jobs:
  lint:
    docker:
      - image: node:12
    steps:
      - checkout
      - run:
          name: Install modules and dependencies.
          command: npm install
      - run:
          name: Check code style and linting
          command: npm run lint
  node8:
    docker:
      - image: node:8
    <<: *unit_tests
  node10:
    docker:
      - image: node:10
    <<: *unit_tests
  node12:
    docker:
      - image: node:12
    <<: *unit_tests
  node13:
    docker:
      - image: node:13
    <<: *unit_tests

workflows:
  version: 2
  build:
    jobs:
      - lint
      - node8
      - node10
      - node12
      - node13
